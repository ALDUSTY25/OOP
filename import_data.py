from app import app, db
from models import Author, Genre, Book

# Добавим данные в application context
with app.app_context():
    # Создаем таблицы 
    db.create_all()

    # Добавляем жанры
    genres = ["Фэнтези", "Научная фантастика", "Роман", "Детектив", "Приключения"]
    genre_objs = [Genre(name=g) for g in genres]
    db.session.add_all(genre_objs)
    db.session.commit()

    # Добавляем авторов
    authors = [
        "Дж. К. Роулинг", "Джордж Оруэлл", "Фёдор Достоевский", "Лев Толстой",
        "Артур Конан Дойл", "Жюль Верн", "Стивен Кинг", "Айзек Азимов",
        "Агата Кристи", "Эрих Мария Ремарк"
    ]
    author_objs = [Author(name=a) for a in authors]
    db.session.add_all(author_objs)
    db.session.commit()

    # Добавляем книги (по 2 от каждого автора)
    books = [
        ("Гарри Поттер и философский камень", "Фэнтези", "Дж. К. Роулинг", 1997),
        ("Гарри Поттер и тайная комната", "Фэнтези", "Дж. К. Роулинг", 1998),
        ("1984", "Научная фантастика", "Джордж Оруэлл", 1949),
        ("Скотный двор", "Научная фантастика", "Джордж Оруэлл", 1945),
        ("Преступление и наказание", "Роман", "Фёдор Достоевский", 1866),
        ("Идиот", "Роман", "Фёдор Достоевский", 1869),
        ("Война и мир", "Роман", "Лев Толстой", 1869),
        ("Анна Каренина", "Роман", "Лев Толстой", 1877),
        ("Шерлок Холмс: Этюд в багровых тонах", "Детектив", "Артур Конан Дойл", 1887),
        ("Собака Баскервилей", "Детектив", "Артур Конан Дойл", 1902),
        ("Дети капитана Гранта", "Приключения", "Жюль Верн", 1868),
        ("20 000 лье под водой", "Приключения", "Жюль Верн", 1870),
        ("Сияние", "Ужасы", "Стивен Кинг", 1977),
        ("Оно", "Ужасы", "Стивен Кинг", 1986),
        ("Основание", "Научная фантастика", "Айзек Азимов", 1951),
        ("Я, робот", "Научная фантастика", "Айзек Азимов", 1950),
        ("Убийство в Восточном экспрессе", "Детектив", "Агата Кристи", 1934),
        ("Десять негритят", "Детектив", "Агата Кристи", 1939),
        ("Три товарища", "Роман", "Эрих Мария Ремарк", 1936),
        ("На западном фронте без перемен", "Роман", "Эрих Мария Ремарк", 1929)
    ]

    for title, genre_name, author_name, year in books:
        genre = Genre.query.filter_by(name=genre_name).first()
        author = Author.query.filter_by(name=author_name).first()
        book = Book(title=title, year=year, genre_id=genre.id, author_id=author.id)
        db.session.add(book)

    db.session.commit()
    print("Данные успешно добавлены!")
